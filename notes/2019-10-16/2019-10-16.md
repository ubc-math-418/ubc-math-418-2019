*Notes 2019-10-16*

MT2: Grading return will be delayed due to a Math 100 exam around the same time.

**Goal**: Solve the equation $x^n \equiv \pmod P$ where $P$ is a prime. 

*Note*: in particular we care about odd primes.

First we must understand the case when $a$ is 1.

**Lemma**: If $d | P - 1$, then there exists $d$ solutions to $x^d \equiv 1 \pmod P$ with $d$ nonnegative.

*Proof*: as we know, the equation $x^d - 1 \equiv 0 \pmod P$ has at most $d$ solutions because it is a monic polynomial. Now, $P-1 \equiv dk$ for some $k\in\mathbb N$. $X^{P-1} - 1 = (x^d - 1) (x^{d(k - 1)} + \ldots x^d + 1)$. By FLT, $X^{P-1} - 1 \equiv 0 \pmod 0$.

Note this is true for any $x$. One of the two parentheses must be divisible by $P$.

For all $1 \leq i \leq P - 1$, we know that $P|(i^d - 1)(i^{d(k-1)} + \ldots i^d + 1).

So either $P | i^d + 1$ *OR* $P | (i^{d(k-1) + \ldots i^d + 1}). However, the latter is a polynomial (equiv. 0 mod $P$), and so it can only have $d(k-1)$ solutions at most. So therefore the remaining $p-d(k-1)-1 \geq d$ values of $i$ which are *not* solutions to that polynomial, so there are at least $d$ values of $i$ s.t. $P | i^d + 1$. $i^d + 1$ cannot have *more* than $d$ solutions, being a degree-$d$ polynomial as well, so therefore there are exactly $d$ values of $i$ s.t. $P | i^d + 1$.

There are precisely $d$ solutions to $x^d \equiv 1 \pmod P$.

**Definition**: let $m \in \mathbb N$ and let $a \in \mathbb Z$ s.t. $\gcd(a, m) = 1$. So there exists an inverse of $a$ modulo $m$. We can also apply Euler's theorem to get that $a^{\phi(m)} \equiv 1 \pmod m$. We define the order of $a$ modulo $m$ to be the smallest positive integer $d$ s.t. $a^d \equiv 1 \pmod m$.

Since $a^{\phi(m)} \equiv 1 \pmod m$. Therefore, $d \leq \phi(m)$. 

Notation: order of $a \text{ modulo } m =: \text{ord}_m(a)$. 

Furthermore, we have that $\text{ord}_m(a) | \phi(m)$.

**Lemma**: if $a^n \equiv 1 \pmod m$, $\text{ord}_m(a) | n$. 

**Proof**: let $d = \text{ord}_m(a)$. Divide $n$ by $d$ (with quotient and remainder) $\Rightarrow$ we can write $n$ as $n= dq + r$ with $o \leq r < d$. Note that $d$ is the least positive integer s.t. $a^d \equiv 1 \pmod m$.

So, $1 \equiv a^n \equiv a^{dq + r} \equiv (a^d)^qa^r \equiv 1^qa^r\equiv a^r$. Since $r < d$, and $d$ is the least positive integer s.t. $a^d \equiv 1$, we must have that $r$ is not positive -- i.e., $r=0$. Therefore, because $n = dq + r$, we have that $n = dq$ and hence $n$ is divisible by $d=\text{ord}_m(a)$.

(This is an easy form of Lagrange's theorem which works for any abelian group.)

**Lemma**: let $d = \text{ord}_m(a)$ (of course, $a$ must be invertible). Then $\text{ord}_{m}(a^k) = \frac d{\gcd(d, k)}$. (This is not surprising given some knowledge of group theory because powers of $a$ are isomorphic to the cyclic group generated by $a$).

*Special Case*: $k=d$. In this case, $\gcd(d, k) = d$, and so $\text{ord}_m(a^k) = 1$ because $a^k \equiv 1$.

If we have $(a^k)^N \equiv 1 \pmod m$ then that means $a^d \equiv 1 \pmod m$.

*Proof*: (a bit ugly). Let's pull out the gcd of $d$ and $k$. Let $e = \gcd(d, k) \Rightarrow d = e\cdot d_1, d_1 \in \mathbb N$ and $k = e\cdot k_1$ with $k_1 \in \mathbb N$ and $\gcd(d_1, k_1) \equiv 1$.

(*Goal*): $\text{ord}_m(a^k) = \frac {d}{\gcd(d, k)} = \frac de = d_1$

$(a^k)^{d_1} \equiv (a^{ek_1})^{d_1} \equiv a^{ek_1d_1} \equiv (a^{ed_1})^{k_1} \equiv (a^d)^{k_1} \equiv 1 \pmod m$

So, $\text{ord}_m(a^k) | d_1$. Now we try to get the reciprocal divisibility.

$1 \equiv (a^k)^{\text{ord}_m(a^k)} \pmod m$

$a^{k \cdot \text{ord}_m(a^k)} \equiv 1 \pmod m$

So $d | k\cdot \text{ord}_m(a^k)$

$e\cdot d_1 | ek_1 \cdot \text{ord}_m(a^k) \Leftrightarrow d_1 | k_1 \cdot \text{ord}_m(a^k)$ Now we use the crucial fact that $d_1$ and $k_1$ are coprime to get that $d_1 | \text{ord}_m a^k$

**Lemma**: if $\text{ord}_m(a_1) = d_1$ and $\text{ord}_m(a_2) = d_2$ and $\gcd(d_1, d_2) = 1$, then $\text{ord}_m(a_1a_2) = d_1d_2$ (sadly it seems hard to remove the coprime restriction and get any kind of cute formula out)

*Proof*: (not that ugly). $(a_1a_2)^{d_1d_2} \equiv (a_1^{d_1})^{d_2} \cdot (a_2^{d_2})^{d_1} \equiv 1 \pmod m$ (both products are 1 modulo $m$). Hence $\text{ord}(a_1a_2) | d_1d_2$

Now,

\begin{align*}
1\equiv&(a_1a_2)^{\text{ord}_m (a_1a_2)}\\
\equiv&(a_1a_2)^{\text{ord}_m (a_1a_2)d_2}\\
\equiv& a_1^{\text{ord}_m(a_1a_2)d_2}a_2^{\text{ord}_m(a_1a_2)d_2}\\
\equiv a_1^{\text{ord}_m(a_1a_2)d_2}\\
\end{align*}

Therefore $d_1 = \text{ord}_m(a_1) | \text{ord}_m(a_1a_2)d_2$. Using the hypothesis about the gcd being 1, we get from this that $\text{ord}_m(a_1) | \text{ord}_m(a_1a_2)$

Similarly, $\text{ord}_m(a_2) | \text{ord}_m(a_1a_2)$

Therefore, because $d_1, d_2$ coprime, we get that $d_1d_2 | \text{ord}_m(a_1a_2)$.
